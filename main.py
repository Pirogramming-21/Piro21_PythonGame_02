import random, sys
import up_and_down_game, imground_game, subway_game, _369_game, apart_game

# ì‚¬ëŒ í´ë˜ìŠ¤ íŒ¨í‚¤ì§€
class Person:
    def __init__(self, name, max_alcohol, is_user=False):
        self.name = name
        self.max_alcohol = max_alcohol
        self.current_drinks = 0
        self.is_user = is_user

    def measure_drink(self):
        return f"{self.name}ì˜ ì£¼ëŸ‰ì€ {self.max_alcohol}ì”ì…ë‹ˆë‹¤."
    
    def drinks_left(self):
        return self.max_alcohol - self.current_drinks
    
    def drink(self, amount):
        self.current_drinks += amount
        return f"{self.name}ì€(ëŠ”) ì§€ê¸ˆê¹Œì§€ {self.current_drinks}ì” ë§ˆì…¨ìŠµë‹ˆë‹¤! ì¹˜ì‚¬ëŸ‰ê¹Œì§€ {self.max_alcohol - self.current_drinks}ì” ë‚¨ì•˜ìŠµë‹ˆë‹¤."
    
    def is_intoxicated(self):
        return self.current_drinks >= self.max_alcohol      

# ê²Œì„ í´ë˜ìŠ¤ íŒ¨í‚¤ì§€
class Game:
    def __init__(self, players:list):
        self.players = players

    def play_game(self):
        print(f'{self.players[0].name}ì´(ê°€) ì¢‹ì•„í•˜ëŠ” ëœë¤ ê²Œì„~ ëœë¤ ê²Œì„~ ë¬´ìŠ¨ ê²Œì„? ')
        while True:
            if self.players[0].is_user:
                try:
                    game_choice = input().strip()
                    if not game_choice.isdigit():
                        raise ValueError
                    game_choice = int(game_choice)
                except ValueError:
                    print("ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
                    continue
            else:
                game_choice = random.randint(1, 5)
            try:
                if game_choice == 1:
                    self.play_subway()
                    return
                elif game_choice == 2:
                    self.play_369()
                    return
                elif game_choice == 3:
                    self.play_updown()
                    return
                elif game_choice == 4:
                    self.play_imground()
                    return
                elif game_choice == 5:
                    self.play_apart()
                    return
                else:
                    print("í•´ë‹¹ ê²Œì„ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
            except ValueError:
                print("ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.")

    def play_subway(self):
        subway_game.play_subway(self.players)

    def play_369(self):
        _369_game.play_369(self.players)

    def play_updown(self):
        up_and_down_game.play_updown(self.players)

    def play_imground(self):
        imground_game.play_imground(self.players)

    def play_apart(self):
        apart_game.play_apart(self.players)

# ì¸íŠ¸ë¡œ í•¨ìˆ˜
def intro():
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("                    â–¡â–¡â–¡â–¡â–¡â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â– â– â– â– â– â–¡â–¡â– â–  ")
    print("                    â–¡â–¡â–¡â–¡â– â– â– â– â–¡â–¡â–¡â–¡â–¡â– â– â– â– â– â–¡â– â– â–¡â– â–¡â–¡â– â– â– â– â– â– â– â–¡â– â–  ")
    print("                    â–¡â–¡â– â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â– â–¡â– â–¡â–¡â– â– â–¡â–¡â–¡â– â– â–¡â– â– ")
    print("                    â–¡â– â– â– â– â–¡â–¡â– â– â– â– â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â– â–¡â– â–¡â–¡â– â– â–¡â–¡â–¡â– â– â–¡â– â– ")
    print("                    â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â– â– â– â–¡â– â–¡â–¡â– â– â– â– â– â– â– â–¡â– â– ")
    print("                    â– â– â– â– â– â– â– â– â– â– â– â– â–¡â–¡â–¡â– â– â– â–¡â– â– â–¡â– â–¡â–¡â–¡â– â– â– â– â– â–¡â–¡â– â– ")
    print("                    â–¡â–¡â–¡â–¡â–¡â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â– â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡")
    print("                    â–¡â–¡â– â– â– â– â– â– â– â– â–¡â–¡â–¡â– â– â– â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â– â– â– â– â– â– â– â– ")
    print("                    â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â–¡â–¡â– â– â– â–¡â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â– â–¡â–¡â–¡â–¡â–¡â– â– ")
    print("                    â–¡â–¡â– â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â– â–¡â–¡â–¡â–¡â–¡â– â– ")
    print("                    â–¡â–¡â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â– â–¡â–¡â–¡â–¡â–¡â– â– ")
    print("                    â–¡â–¡â– â– â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â– â– â–¡â– â–¡â–¡â–¡â–¡â– â– â– â– â– â– â– â– ")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("        ğŸ¤ì•ˆì£¼ğŸ¤ ë¨¹ì„ ì‹œê°„ì´ ì—†ì–´ìš”~âŒ ë§ˆì‹œë©´ì„œ ë°°ìš°ëŠ” ğŸ» ìˆ â—ê²Œâ—ì„â—ğŸ»")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("ğŸ»ğŸ¼ì†Œì£¼ í•œ ì” í• ë˜ìš”~~ğŸ¼ğŸ»(y/n)")
    choice = input().strip().lower()
    if choice == 'y':
        return False
    elif choice == 'n':
        print("ê²Œì„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
        sys.exit()
        return True
    else:
        print("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. 'y' ë˜ëŠ” 'n'ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        return True

# í”Œë ˆì´ì–´ ìˆ˜ ê²°ì • í•¨ìˆ˜
def num_players():
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    while True:
        try:
            num = int(input("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§   í•¨ê»˜ ì·¨í•  ì¹œêµ¬ë“¤ì€ ì–¼ë§ˆë‚˜ í•„ìš”í•˜ì‹ ê°€ìš”? (ìµœëŒ€ 3ëª…)   ğŸ‘¨â€ğŸ‘©â€ğŸ‘§  "))
            if 0 <= num <= 3:
                return num
            else:
                print("0ì—ì„œ 3ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.")
        except ValueError:
            print("ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.")

# ê²Œì„ ë¦¬ìŠ¤íŠ¸ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
def show_game_list():
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ğŸ® ê²Œì„ ë¦¬ìŠ¤íŠ¸ ğŸ®~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    print("1. ì§€í•˜ì²  ê²Œì„")
    print("2. 369 ê²Œì„")
    print("3. Up & Down ê²Œì„")
    print("4. ì•„ì´ì— ê·¸ë¼ìš´ë“œ ê²Œì„")
    print("5. ì•„íŒŒíŠ¸ ê²Œì„")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")

# ë©”ì¸ ê²Œì„ ë¡œì§
def main_game():

    # 1. ê²Œì„ í• ê¹Œë§ê¹Œ ì—¬ë¶€    
    while intro():
        print("")

    # 2. ì‚¬ìš©ì(ì£¼ì¸ê³µ) ì´ë¦„ ë°›ê¸°
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    player_name = input("ğŸ˜µì˜¤ëŠ˜ ì²« ì°¨ íƒˆ ë‹¹ì‹ ì˜ ì´ë¦„ì€?ğŸ˜µ   ")

    # 3. ì‚¬ìš©ì(ì£¼ì¸ê³µ) ì£¼ëŸ‰ ì„ íƒí•˜ê¸°
    choice_list = '~~~~~~~~~ğŸ» ì†Œì£¼ ê¸°ì¤€ ë‹¹ì‹ ì˜ ì£¼ëŸ‰ì€? ğŸ»~~~~~~~~~~\n'\
    'ğŸ» 1. ì†Œì£¼ ë°˜ ë³‘ (2ì”)\n'\
    'ğŸ» 2. ì†Œì£¼ ë°˜ ë³‘ì—ì„œ í•œ ë³‘ (4ì”)\n'\
    'ğŸ» 3. ì†Œì£¼ í•œ ë³‘ì—ì„œ í•œ ë³‘ ë°˜ (6ì”)\n'\
    'ğŸ» 4. ì†Œì£¼ í•œ ë³‘ ë°˜ì—ì„œ ë‘ ë³‘ (8ì”)\n'\
    'ğŸ» 5. ì†Œì£¼ ë‘ ë³‘ ì´ìƒ (10ì”)'

    print(choice_list)
    while True:
        chosen_num = input("ë‹¹ì‹ ì˜ ì¹˜ì‚¬ëŸ‰(ì£¼ëŸ‰)ì€ ì–¼ë§ˆë§Œí¼ì¸ê°€ìš”?(1~5ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”): ")
        try:
            player_alcohol = 2 * int(chosen_num)
            if player_alcohol not in [2,4,6,8,10]:
                print("ë³´ê¸°ì— ìˆëŠ” ìˆ«ìë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.")
                continue
            else:
                break
        except:
            print("ìˆ«ìë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
    player = Person(player_name, player_alcohol, is_user=True)

    #4-1. ëŒ€ê²°í•  ì‚¬ëŒ ì´ˆëŒ€
    capacity = [2, 4, 6, 8, 10]
    player1 = Person("ì€ì„œ", random.choice(capacity)) #ì£¼ëŸ‰ 2,4,6,8,10 ì¤‘ ëœë¤ì„ íƒ
    player2 = Person("í•˜ì—°", random.choice(capacity))
    player3 = Person("ì—°ì„œ", random.choice(capacity))
    player4 = Person("ì˜ˆì§„", random.choice(capacity))
    player5 = Person("í—Œë„", random.choice(capacity))

    players = [player1, player2, player3, player4, player5]
    opponents = random.sample(players, k = num_players())

    #4-2. ê²Œì„ ë©¤ë²„ë“¤ ì†Œê°œ
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    for opponent in opponents:
        print(f"ğŸ¤— ì•ˆë…•? ë‚œ {opponent.name}(ì´)ê³ , ë‚´ ì£¼ëŸ‰ì€ ğŸ¥ƒ {opponent.max_alcohol}ì”ì´ì•¼ ğŸ¤—")
    print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
    # ì£¼ì¸ê³µ + ì¶”ê°€ëœ ëœë¤ í”Œë ˆì´ì–´ë“¤
    gamers = []
    gamers.append(player)
    gamers.extend(opponents)

    # ë§ˆì‹  ì” ìˆ˜ ë° ì¹˜ì‚¬ëŸ‰ ì¶œë ¥    
    for gamer in gamers:
        print(gamer.drink(0))

    #4-3. ê²Œì„ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥
    show_game_list()

    # ì´ë¯¸ í”Œë ˆì´í•œ í”Œë ˆì´ì–´ 
    played_gamers = []

    #5. ê²Œì„ ì‹œì‘    
    # ê²Œì„ ì„ íƒ ë° ì‹¤í–‰
    while True:
        # ê²Œì´ë¨¸ë“¤ ì§€ì •
        starter = gamers[0]  # ê²Œì„ ì‹œì‘í•˜ëŠ” ì‚¬ëŒ

        # ê²Œì„ ì‹œì‘!
        game = Game(gamers)
        game.play_game()

        # ê²Œì„ í›„ í”Œë ˆì´ì–´ë“¤ ë§ˆì‹  ì” ìˆ˜ ë° ë‚¨ì€ ì” ìˆ˜ ì¶œë ¥
        for gamer in gamers:
            print(gamer.drink(0))

        # ì£½ì€ ì‚¬ëŒ ìˆëŠ”ì§€ í™•ì¸
        for gamer in gamers:
            if gamer.is_intoxicated():
                print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
                print("â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›")
                print("â¬›â¬›â¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›")
                print("â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œ")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬œâ¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œ")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œ")
                print("â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›")
                print("â¬›â¬›â¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›")
                print("â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›")
                print("â¬›â¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬œâ¬œâ¬œâ¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬›â¬›")
                print("â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬œâ¬›â¬›â¬›â¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬›â¬œâ¬œâ¬›â¬œâ¬œâ¬œâ¬›â¬›")
                print("â¬›â¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬›â¬›â¬›â¬›â¬œâ¬›â¬›â¬›â¬›â¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬œâ¬›â¬œâ¬œâ¬›â¬›â¬œâ¬œâ¬œâ¬›")
                print("â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›â¬›")
                print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
                print("                                  ğŸ“£ GAME OVER ğŸ“£")
                print("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")
                print(f"ğŸ˜´ {gamer.name}ì´(ê°€) ì „ì‚¬í–ˆìŠµë‹ˆë‹¤... ğŸŒ™ ê¿ˆë‚˜ë¼ì—ì„œëŠ” í¸íˆ ì‰¬ì‹œê¸¸..zzz ğŸŒ™")
                sys.exit()
        # í•œíŒ ë” í• ê±´ì§€ ì—¬ë¶€ ë¬¼ì–´ë³´ê¸°
        show_game_list()
        print('ìˆ ê²Œì„ ì§„í–‰ì¤‘! ê·¸ë§Œí•˜ê³  ì‹¶ìœ¼ë©´ "exit"ì„, ê³„ì†í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë¬´í‚¤ë‚˜ ì…ë ¥í•´ ì£¼ì„¸ìš”!:  ', end="")
        end_yn = input().strip().lower()
        if end_yn == "exit":
            print("ğŸ˜„ ì¦ê±°ìš´ ê²Œì„ì´ì—ˆìŠµë‹ˆë‹¤!!!! ğŸ˜„")
            sys.exit()
        else:
            # ë‹¤ìŒ í”Œë ˆì´ì–´ ì„¤ì •
            played_gamers.append(gamers[0])
            if len(played_gamers) == len(gamers):
                played_gamers = [gamers[0]]
            
            while True:
                next_player_index = random.randint(1, len(gamers) - 1)
                if gamers[next_player_index] in played_gamers:
                    continue
                else:
                    break 
            starter = gamers.pop(next_player_index)
            gamers.insert(0, starter)

if __name__ == "__main__":
    main_game()
